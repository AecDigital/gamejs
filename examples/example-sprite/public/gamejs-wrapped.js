require.define({gamejs:function(g,a){function f(){var b=0,d=0,c=0,h=0;if(arguments.length===2)arguments[0]instanceof Array&&arguments[1]instanceof Array?(b=arguments[0][0],d=arguments[0][1],c=arguments[1][0],h=arguments[1][1]):(b=arguments[0],d=arguments[1]);else if(arguments.length===1&&arguments[0]instanceof Array)b=arguments[0][0],d=arguments[0][1],c=arguments[0][2],h=arguments[0][3];else if(arguments.length===1&&arguments[0]instanceof k)b=arguments[0].left,d=arguments[0].top,c=arguments[0].width,
h=arguments[0].height;else if(arguments.length===4)b=arguments[0],d=arguments[1],c=arguments[2],h=arguments[3];else throw Error("not a valid rectangle specification");return{left:b||0,top:d||0,width:c||0,height:h||0}}var e=g("./gamejs/utils/matrix"),c=g("./gamejs/utils/objects"),d=["info","warn","error","fatal"],b=2;a.setLogLevel=function(c){if(typeof c==="string"&&d.indexOf(c))b=d.indexOf(c);else if(typeof c==="number")b=c;else throw Error("invalid logLevel ",c," Must be one of: ",d);return b};var h=
a.log=function(){var b=Array.prototype.slice.apply(arguments,[0]);b.unshift(Date.now());window.console!==void 0&&console.log.apply&&console.log.apply(console,b)};a.debug=function(){b>0||h.apply(this,arguments)};a.warn=function(){b>1||h.apply(this,arguments)};a.error=function(){b>2||h.apply(this,arguments)};var k=a.Rect=function(){var b=f.apply(this,arguments);this.left=b.left;this.top=b.top;this.width=b.width;this.height=b.height;return this};c.accessors(k.prototype,{bottom:{get:function(){return this.top+
this.height},set:function(b){this.top=b-this.height}},right:{get:function(){return this.left+this.width},set:function(b){this.left=b-this.width}},center:{get:function(){return[this.left+this.width/2,this.top+this.height/2]},set:function(){var b=f.apply(this,arguments);this.left=b.left-this.width/2;this.top=b.top-this.height/2}}});k.prototype.move=function(){var b=f.apply(this,arguments);return new k(this.left+b.left,this.top+b.top,this.width,this.height)};k.prototype.moveIp=function(){var b=f.apply(this,
arguments);this.left+=b.left;this.top+=b.top};k.prototype.collidePoint=function(){var b=f.apply(this,arguments);return this.left<=b.left&&b.left<=this.right&&this.top<=b.top&&b.top<=this.bottom};k.prototype.collideRect=function(b){return!(this.left>b.right||this.right<b.left||this.top>b.bottom||this.bottom<b.top)};k.prototype.collideLine=function(b,d){var c=b[0],h=b[1],a=d[0],k=d[1],e=!0,f=!0,i=!0;[[this.left,this.top],[this.left,this.bottom],[this.right,this.top],[this.right,this.bottom]].map(function(b){return(k-
h)*b[0]+(c-a)*b[1]+(a*h-c*k)}).forEach(function(b){b>0&&(f=!1);b<0&&(e=!1);b===0&&(i=!1)},this);if((e||f)&&i)return!1;return!(c>this.right&&a>this.right||c<this.left&&a<this.left||h<this.top&&k<this.top||h>this.bottom&&k>this.bottom)};k.prototype.toString=function(){return["[",this.left,",",this.top,"] [",this.width,",",this.height,"]"].join("")};k.prototype.clone=function(){return new k(this)};var i=a.Surface=function(){var b=f.apply(this,arguments),d=b.left,c=b.top;if(arguments.length==1&&arguments[0]instanceof
k)d=b.width,c=b.height;this._matrix=e.identity();this._canvas=document.createElement("canvas");this._canvas.width=d;this._canvas.height=c;this._blitAlpha=1;return this};i.prototype.blit=function(b,d,c){if(d instanceof k){var d=d.clone(),h=b.getSize();if(!d.width)d.width=h[0];if(!d.height)d.height=h[1]}else d=d&&d instanceof Array&&d.length==2?new k(d,b.getSize()):new k([0,0],b.getSize());c=c instanceof k?c:c&&c instanceof Array&&c.length==2?new k(c,b.getSize()):new k([0,0],b.getSize());if(isNaN(d.left)||
isNaN(d.top)||isNaN(d.width)||isNaN(d.height))throw Error("[blit] bad parameters, destination is "+d);this.context.save();h=e.translate(e.identity(),d.left,d.top);h=e.multiply(h,b._matrix);this.context.transform(h[0],h[1],h[2],h[3],h[4],h[5]);srcRect=b.getRect();this.context.globalAlpha=b._blitAlpha;this.context.drawImage(b.canvas,c.left,c.top,c.width,c.height,0,0,d.width,d.height);this.context.restore()};i.prototype.getSize=function(){return[this.canvas.width,this.canvas.height]};i.prototype.getRect=
function(){return new k([0,0],this.getSize())};i.prototype.fill=function(b){this.context.save();this.context.fillStyle=b||"#000000";this.context.fillRect(0,0,this.canvas.width,this.canvas.height);this.context.restore()};i.prototype.clear=function(){var b=this.getSize();this.context.clearRect(0,0,b[0],b[1])};c.accessors(i.prototype,{rect:{get:function(){return this.getRect()}},context:{get:function(){return this._canvas.getContext("2d")}},canvas:{get:function(){return this._canvas}}});i.prototype.clone=
function(){var b=new i(this.getRect());b.blit(this);return b};i.prototype.getAlpha=function(){return 1-this._blitAlpha};i.prototype.setAlpha=function(b){if(!isNaN(b)&&!(b<0||b>1))return this._blitAlpha=1-b,1-this._blitAlpha};i.prototype.getImageData=function(){var b=this.getSize();return this.context.getImageData(0,0,b[0],b[1]).data};a.display=g("./gamejs/display");a.draw=g("./gamejs/draw");a.event=g("./gamejs/event");a.font=g("./gamejs/font");a.http=g("./gamejs/http");a.image=g("./gamejs/image");
a.mask=g("./gamejs/mask");a.mixer=g("./gamejs/mixer");a.sprite=g("./gamejs/sprite");a.surfacearray=g("./gamejs/surfacearray");a.time=g("./gamejs/time");a.transform=g("./gamejs/transform");a.utils={arrays:g("./gamejs/utils/arrays"),objects:g("./gamejs/utils/objects"),matrix:g("./gamejs/utils/matrix")};a.pathfinding={astar:g("./gamejs/pathfinding/astar")};var j=a,m={};a.ready=function(b){function d(){if(!document.body)return window.setTimeout(d,50);a=j.image.preload(m);try{h=j.mixer.preload(m)}catch(b){j.debug("Error loading audio files ",
b)}window.setTimeout(c,50)}function c(){if(a()<1||h()<1)return window.setTimeout(c,100);j.time.init();j.display.init();j.image.init();j.mixer.init();j.event.init();b()}var h=null,a=null;window.setTimeout(d,13);return function(){if(a)return 0.5*a()+0.5*h();return 0.1}};a.preload=function(b){b.forEach(function(b){m[b]=((window.$g&&$g.resourceBaseHref||".")+"/"+b).replace(/\/+/g,"/")},this)}}},["gamejs/utils/matrix","gamejs/utils/objects","gamejs/display","gamejs/draw","gamejs/event","gamejs/font","gamejs/http",
"gamejs/image","gamejs/mask","gamejs/mixer","gamejs/sprite","gamejs/surfacearray","gamejs/time","gamejs/transform","gamejs/utils/arrays","gamejs/pathfinding/astar"]);
require.define({"gamejs/transform":function(g,a){var f=g("../gamejs").Surface,e=g("./utils/matrix");a.rotate=function(c,d){var b=c.getSize(),h=new f(b),a=c._matrix;c._matrix=e.translate(c._matrix,b[0]/2,b[1]/2);c._matrix=e.rotate(c._matrix,d*Math.PI/180);c._matrix=e.translate(c._matrix,-b[0]/2,-b[1]/2);h.blit(c);c._matrix=a;return h};a.scale=function(c,d){var b=d[0],h=d[1],a=c.getSize(),a=[a[0]*d[0],a[1]*d[1]],a=new f(a);a._matrix=e.scale(a._matrix,[b,h]);a.blit(c);return a};a.flip=function(c,d,b){var h=
c.getSize(),a=new f(h),e=1,j=1,g=0,l=0;d===!0&&(e=-1,g=-h[0]);b===!0&&(j=-1,l=-h[1]);a.context.save();a.context.scale(e,j);a.context.drawImage(c.canvas,g,l);a.context.restore();return a}}},["gamejs","gamejs/utils/matrix"]);
require.define({"gamejs/time":function(g,a){var f={},e={};a.init=function(){Date.now();setInterval(c,10)};a.fpsCallback=function(d,b,c){c=parseInt(1E3/c,10);f[c]===void 0&&(f[c]=[]);e[c]===void 0&&(e[c]=0);f[c].push({rawFn:d,callback:function(c){d.apply(b,[c])}})};a.deleteCallback=function(d,b){var b=parseInt(1E3/b,10),c=f[b];c&&(f[b]=c.filter(function(b){if(b.rawFn!==d)return!0;return!1}))};var c=function(){var d=Date.now(),b;for(b in e){e[b]||(e[b]=d);var c=d-e[b];b<=c&&(e[b]=d,f[b].forEach(function(b){b.callback(c)},
this))}}}},[]);
require.define({"gamejs/mask":function(g,a){var f=g("../gamejs"),e=g("./utils/objects");a.fromSurface=function(d,b){for(var b=b&&255-b||255,a=d.getImageData(),e=d.getSize(),f=new c(e),j=0;j<a.length;j+=4){var g=parseInt(j/4/e[0],10),l=parseInt(j/4%e[0],10);a[j+3]>=b&&f.setAt(l,g)}return f};var c=a.Mask=function(d){this.width=d[0];this.height=d[1];this._bits=[];for(d=0;d<this.width;d++){this._bits[d]=[];for(var b=0;b<this.height;b++)this._bits[d][b]=!1}};c.prototype.overlapRect=function(d,b){var c=
this.rect,a=d.rect;b&&a.moveIp(b);if(!a.collideRect(c))return null;var e=Math.max(c.left,a.left),j=Math.max(c.top,a.top);return new f.Rect([e,j],[Math.min(c.right,a.right)-e,Math.min(c.bottom,a.bottom)-j])};c.prototype.overlap=function(c,b){var a=this.overlapRect(c,b);if(a===null)return!1;var e=this.rect,f=c.rect;b&&f.moveIp(b);for(var j=a.top;j<=a.bottom;j++)for(var g=a.left;g<=a.right;g++)if(this.getAt(g-e.left,j-e.top)&&c.getAt(g-f.left,j-f.top))return!0;return!1};c.prototype.overlapArea=function(c,
b){var a=this.overlapRect(c,b);if(a===null)return 0;var e=this.rect,f=c.rect;b&&f.moveIp(b);for(var j=0,g=a.top;g<=a.bottom;g++)for(var l=a.left;l<=a.right;l++)this.getAt(l-e.left,g-e.top)&&c.getAt(l-f.left,g-f.top)&&j++;return j};c.prototype.overlapMask=function(d,b){var a=this.overlapRect(d,b);if(a===null)return 0;var e=this.rect,f=d.rect;b&&f.moveIp(b);for(var g=new c([a.width,a.height]),m=a.top;m<=a.bottom;m++)for(var l=a.left;l<=a.right;l++)this.getAt(l-e.left,m-e.top)&&d.getAt(l-f.left,m-f.top)&&
g.setAt(l,m);return g};c.prototype.setAt=function(c,b){this._bits[c][b]=!0};c.prototype.getAt=function(c,b){c=parseInt(c,10);b=parseInt(b,10);if(c<0||b<0||c>=this.width||b>=this.height)return!1;return this._bits[c][b]};c.prototype.invert=function(){this._bits=this._bits.map(function(c){return c.map(function(b){return!b})})};c.prototype.getSize=function(){return[this.width,this.height]};e.accessors(c.prototype,{rect:{get:function(){return new f.Rect([0,0],[this.width,this.height])}},length:{get:function(){var c=
0;this._bits.forEach(function(b){b.forEach(function(b){b&&c++})});return c}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/event":function(g,a){var f=g("./display"),e=g("../gamejs");a.K_UP=38;a.K_DOWN=40;a.K_RIGHT=39;a.K_LEFT=37;a.K_SPACE=32;a.K_TAB=9;a.K_ENTER=13;a.K_CTRL=17;a.K_ALT=18;a.K_ESC=27;a.K_0=48;a.K_1=49;a.K_2=50;a.K_3=51;a.K_4=52;a.K_5=53;a.K_6=54;a.K_7=55;a.K_8=56;a.K_9=57;a.K_a=65;a.K_b=66;a.K_c=67;a.K_d=68;a.K_e=69;a.K_f=70;a.K_g=71;a.K_h=72;a.K_i=73;a.K_j=74;a.K_k=75;a.K_l=76;a.K_m=77;a.K_n=78;a.K_o=79;a.K_p=80;a.K_q=81;a.K_r=82;a.K_s=83;a.K_t=84;a.K_u=85;a.K_v=86;a.K_w=87;a.K_x=
88;a.K_y=89;a.K_z=90;a.K_KP1=97;a.K_KP2=98;a.K_KP3=99;a.K_KP4=100;a.K_KP5=101;a.K_KP6=102;a.K_KP7=103;a.K_KP8=104;a.K_KP9=105;a.QUIT=0;a.KEY_DOWN=1;a.KEY_UP=2;a.MOUSE_MOTION=3;a.MOUSE_UP=4;a.MOUSE_DOWN=5;a.MOUSE_WHEEL=6;var c=[];a.get=function(){return c.splice(0,c.length)};a.poll=function(){return c.pop()};a.post=function(d){c.push(d)};a.Event=function(){this.pos=this.button=this.rel=this.key=this.type=null};a.init=function(){function d(b){var d=f._getCanvasOffset();c.push({type:e.event.MOUSE_WHEEL,
pos:[b.clientX-d[0],b.clientY-d[1]],delta:b.detail||-b.wheelDeltaY/40})}document.addEventListener("mousedown",function(b){var d=f._getCanvasOffset();c.push({type:e.event.MOUSE_DOWN,pos:[b.clientX-d[0],b.clientY-d[1]],button:b.button})},!1);document.addEventListener("mouseup",function(b){var d=f._getCanvasOffset();c.push({type:e.event.MOUSE_UP,pos:[b.clientX-d[0],b.clientY-d[1]],button:b.button})},!1);document.addEventListener("keydown",function(b){var d=b.keyCode||b.which;c.push({type:e.event.KEY_DOWN,
key:d,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey});!b.ctrlKey&&!b.metaKey&&(d>=a.K_LEFT&&d<=a.K_DOWN||d>=a.K_0&&d<=a.K_z||d>=a.K_KP1&&d<=a.K_KP9||d===a.K_SPACE||d===a.K_TAB||d===a.K_ENTER)&&b.preventDefault()},!1);document.addEventListener("keyup",function(b){c.push({type:e.event.KEY_UP,key:b.keyCode,shiftKey:b.shiftKey,ctrlKey:b.ctrlKey,metaKey:b.metaKey})},!1);var b=[];document.addEventListener("mousemove",function(d){var a=f._getCanvasOffset(),a=[d.clientX-a[0],d.clientY-a[1]],g=[];
b.length&&(g=[b[0]-a[0],b[1]-a[1]]);c.push({type:e.event.MOUSE_MOTION,pos:a,rel:g,buttons:null,timestamp:d.timeStamp});b=a},!1);document.addEventListener("mousewheel",d,!1);document.addEventListener("DOMMouseScroll",d,!1);document.addEventListener("beforeunload",function(){c.push({type:e.event.QUIT})},!1)}}},["gamejs/display","gamejs"]);
require.define({"gamejs/draw":function(g,a){a.line=function(a,e,c,d,b){a=a.context;a.save();a.beginPath();a.strokeStyle=e;a.lineWidth=b||1;a.moveTo(c[0],c[1]);a.lineTo(d[0],d[1]);a.stroke();a.restore()};a.lines=function(a,e,c,d,b){c=c||!1;a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;for(e=0;e<d.length;e++)b=d[e],e===0?a.moveTo(b[0],b[1]):a.lineTo(b[0],b[1]);c&&a.lineTo(d[0][0],d[0][1]);a.stroke();a.restore()};a.circle=function(a,e,c,d,b){if(!d)throw Error("[circle] radius required argument");
if(!c||!typeof c==="array")throw Error("[circle] pos must be given & array"+c);a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=e;a.lineWidth=b||1;a.arc(c[0],c[1],d,0,2*Math.PI,!0);b===void 0||b===0?a.fill():a.stroke();a.restore()};a.rect=function(a,e,c,d){a=a.context;a.save();a.strokeStyle=a.fillStyle=e;isNaN(d)||d===0?a.fillRect(c.left,c.top,c.width,c.height):(a.lineWidth=d,a.strokeRect(c.left,c.top,c.width,c.height));a.restore()};a.arc=function(a,e,c,d,b,h){a=a.context;a.save();a.strokeStyle=
a.fillStyle=e;a.arc(c.center[0],c.center[1],c.width/2,d*(Math.PI/180),b*(Math.PI/180),!1);isNaN(h)||h===0?a.fill():(a.lineWidth=h,a.stroke());a.restore()};a.polygon=function(a,e,c,d){this.lines(a,e,!0,c,d)}}},[]);
require.define({"gamejs/display":function(g,a){var f=g("../gamejs").Surface;a.init=function(){var a=null;c()===null&&(a=document.createElement("canvas"),a.setAttribute("id","gjs-canvas"),document.body.appendChild(a));(a=document.getElementById("gjs-loader"))&&a.parentNode.removeChild(a)};a.setMode=function(a){var b=c();b.width=a[0];b.height=a[1];return e()};a.setCaption=function(a){document.title=a};a._getCanvasOffset=function(){var a=c().getBoundingClientRect();return[a.left,a.top]};var e=a.getSurface=
function(){if(b==null){var a=c(),b=new f([a.clientWidth,a.clientHeight]);b._canvas=a}return b},c=function(){var a=null;Array.prototype.slice.call(document.getElementsByTagName("canvas")).every(function(b){if(b.getAttribute("id")=="gjs-canvas")return a=b,!1;return!0});return a}}},["gamejs"]);
require.define({"gamejs/surfacearray":function(g,a){var f=g("../gamejs"),e=g("./utils/objects").accessors;a.blitArray=function(a,d){a.context.putImageData(d.imageData,0,0)};a.SurfaceArray=function(a){this.set=function(a,c,e){a=a*4+c*d[0]*4;b[a]=e[0];b[a+1]=e[1];b[a+2]=e[2];b[a+3]=e[3]===void 0?255:e[3]};this.get=function(a,c){var e=a*4+c*d[0]*4;return[b[e],b[e+1],b[e+2],b[e+3]]};this.surface=null;e(this,{surface:{get:function(){var b=new f.Surface(d);b.context.putImageData(h,0,0);return b}},imageData:{get:function(){return h}}});
this.getSize=function(){return d};var d=null,b=null,h=null;a instanceof Array?(d=a,h=f.display.getSurface().context.createImageData(d[0],d[1]),b=h.data):(d=a.getSize(),b=h=a.getImageData(0,0,d[0],d[1]));return this}}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/http":function(g,a){function f(b){return eval("("+b.responseText+")")}a.Response=function(){this.getResponseHeader=function(){};throw Error("response class not instantiable");};var e=a.ajax=function(b,a,c,d){var c=c||null,e=new XMLHttpRequest;e.open(b,a,!1);d&&e.setRequestHeader("Accept",d);c instanceof Object&&(c=JSON.stringify(c),e.setRequestHeader("Content-Type","application/json"));e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.send(c);return e},c=a.get=function(b){return e("GET",
b)},d=a.post=function(b,a,c){return e("POST",b,a,c)};a.load=function(b){return f(c((window.$g&&$g.ajaxBaseHref||"./")+b))};a.save=function(b,a,c){return f(d((window.$g&&$g.ajaxBaseHref||"./")+b,{payload:a},c))}}},[]);
require.define({"gamejs/sprite":function(g,a){g("../gamejs");var f=g("./utils/arrays"),e=a.Sprite=function(){this._groups=[];this._alive=!0;this.rect=this.image=null;return this};e.prototype.kill=function(){this._alive=!1;this._groups.forEach(function(b){b.remove(this)},this)};e.prototype.remove=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){b.remove(this)},this)};e.prototype.add=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){b.add(this)},this)};e.prototype.draw=function(b){b.blit(this.image,
this.rect)};e.prototype.update=function(){};e.prototype.isDead=function(){return!this._alive};var c=a.Group=function(b){this._sprites=[];(b instanceof e||b instanceof Array&&b.length&&b[0]instanceof e)&&this.add(b);return this};c.prototype.update=function(){var b=arguments;this._sprites.forEach(function(a){a.update.apply(a,b)},this)};c.prototype.add=function(b){b instanceof Array||(b=[b]);b.forEach(function(b){this._sprites.push(b);b._groups.push(this)},this)};c.prototype.remove=function(b){b instanceof
Array||(b=[b]);b.forEach(function(b){f.remove(b,this._sprites);f.remove(this,b._groups)},this)};c.prototype.has=function(b){b instanceof Array||(b=[b]);return b.every(function(b){return this._sprites.indexOf(b)!==-1},this)};c.prototype.sprites=function(){return this._sprites};c.prototype.draw=function(){var b=arguments;this._sprites.forEach(function(a){a.draw.apply(a,b)},this)};c.prototype.empty=function(){this._sprites=[]};c.prototype.collidePoint=function(){var b=Array.prototype.slice.apply(arguments);
return this._sprites.filter(function(a){return a.rect.collidePoint.apply(a.rect,b)},this)};c.prototype.forEach=function(){Array.prototype.forEach.apply(this._sprites,arguments)};c.prototype.some=function(){return Array.prototype.some.apply(this._sprites,arguments)};a.spriteCollide=function(b,a,c,e){var e=e||d,c=c||!1,f=[];a.sprites().forEach(function(a){e(b,a)&&(c&&a.kill(),f.push(a))});return f};a.groupCollide=function(b,a,c,e){var c=c||!1,e=e||!1,f=[];b.sprites().forEach(function(b){a.sprites().forEach(function(a){d(b,
a)&&(c&&b.kill(),e&&a.kill(),f.push({a:b,b:a}))})});return f};var d=a.collideRect=function(b,a){return b.rect.collideRect(a.rect)};a.collideMask=function(b,a){if(!b.mask||!a.mask)throw Error("Both sprites must have 'mask' attribute set to an gamejs.mask.Mask");return b.mask.overlap(a.mask,[a.rect.left-b.rect.left,a.rect.top-b.rect.top])}}},["gamejs","gamejs/utils/arrays"]);
require.define({"gamejs/font":function(g,a){var f=g("../gamejs").Surface,e=g("./utils/objects"),c=a.Font=function(a){this.sampleSurface=new f([10,10]);this.sampleSurface.context.font=a;this.sampleSurface.context.textAlign="start";this.sampleSurface.context.textBaseline="bottom";return this};c.prototype.render=function(a,b){var c=this.size(a),c=new f(c),e=c.context;e.save();e.font=this.sampleSurface.context.font;e.textBaseline=this.sampleSurface.context.textBaseline;e.textAlign=this.sampleSurface.context.textAlign;
e.fillStyle=e.strokeStyle=b||"#000000";e.fillText(a,0,c.rect.height,c.rect.width);e.restore();return c};c.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width,this.fontHeight]};e.accessors(c.prototype,{fontHeight:{get:function(){return this.sampleSurface.context.measureText("M").width*1.5}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/pathfinding/astar":function(g,a){function f(){var a={};this.store=function(b,c){a[b[0]+"-"+b[1]]=c};this.find=function(b){return a[b[0]+"-"+b[1]]};return this}var e=g("../utils/binaryheap").BinaryHeap;a.findRoute=function(a,b,c,g){function i(a){j.push(a);m.store(a.point,a)}var j=new e(function(b){if(b.score==void 0)b.score=a.estimatedDistance(b.point,c)+b.length;return b.score}),m=new f;i({point:b,from:null,length:0});for(b=Date.now();j.size()>0&&(!g||Date.now()-b<g);){var l=
j.pop();if(c[0]===l.point[0]&&c[1]===l.point[1])return l;a.adjacent(l.point).forEach(function(b){var c=m.find(b),e=l.length+a.actualDistance(l.point,b);if(!c||c.length>e)c&&j.remove(c),i({point:b,from:l,length:e})})}return null};var c=a.Map=function(){throw Error("not instantiable, this is an interface");};c.prototype.adjacent=function(){};c.prototype.estimatedDistance=function(){};c.prototype.actualDistance=function(){}}},["gamejs/utils/binaryheap"]);
require.define({"gamejs/utils/arrays":function(g,a){a.remove=function(a,e){return e.splice(e.indexOf(a),1)}}},[]);
require.define({"gamejs/utils/vectors":function(g,a){a.distance=function(a,d){return e(f(a,d))};var f=a.substract=function(a,d){return[a[0]-d[0],a[1]-d[1]]};a.add=function(a,d){return[a[0]+d[0],a[1]+d[1]]};a.multiply=function(a,d){if(typeof d==="number")return[a[0]*d,a[1]*d];return[a[0]*d[0],a[1]*d[1]]};a.divide=function(a,d){if(typeof d==="number")return[a[0]/d,a[1]/d];throw Error("only divide by scalar supported");};var e=a.len=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])};a.unit=function(a){var d=
e(a);return[a[0]/d,a[1]/d]}}},[]);
require.define({"gamejs/utils/matrix":function(g,a){a.identity=function(){return[1,0,0,1,0,0]};a.add=function(a,c){return[a[0]+c[0],a[1]+c[1],a[2]+c[2],a[3]+c[3],a[4]+c[4],a[5]+c[5],a[6]+c[6]]};var f=a.multiply=function(a,c){return[a[0]*c[0]+a[2]*c[1],a[1]*c[0]+a[3]*c[1],a[0]*c[2]+a[2]*c[3],a[1]*c[2]+a[3]*c[3],a[0]*c[4]+a[2]*c[5]+a[4],a[1]*c[4]+a[3]*c[5]+a[5]]};a.translate=function(a,c,d){return f(a,[1,0,0,1,c,d])};a.rotate=function(a,c){var d=Math.sin(c),b=Math.cos(c);return f(a,[b,d,-d,b,0,0])};
a.rotation=function(a){return Math.atan2(a[1],a[0])};a.scale=function(a,c){return f(a,[c[0],0,0,c[1],0,0])}}},[]);
require.define({"gamejs/utils/binaryheap":function(g,a){var f=a.BinaryHeap=function(a){this.content=[];this.scoreFunction=a;return this};f.prototype.push=function(a){this.content.push(a);this.sinkDown(this.content.length-1)};f.prototype.pop=function(){var a=this.content[0],c=this.content.pop();this.content.length>0&&(this.content[0]=c,this.bubbleUp(0));return a};f.prototype.remove=function(a){if(!this.content.some(function(c,d){if(c==a){var b=this.content.pop();d!=this.content.length&&(this.content[d]=
b,this.scoreFunction(b)<this.scoreFunction(a)?this.sinkDown(d):this.bubbleUp(d));return!0}return!1},this))throw Error("Node not found.");};f.prototype.size=function(){return this.content.length};f.prototype.sinkDown=function(a){for(var c=this.content[a];a>0;){var d=Math.floor((a+1)/2)-1,b=this.content[d];if(this.scoreFunction(c)<this.scoreFunction(b))this.content[d]=c,this.content[a]=b,a=d;else break}};f.prototype.bubbleUp=function(a){for(var c=this.content.length,d=this.content[a],b=this.scoreFunction(d);;){var f=
(a+1)*2,g=f-1,i=null;if(g<c){var j=this.scoreFunction(this.content[g]);j<b&&(i=g)}if(f<c&&this.scoreFunction(this.content[f])<(i==null?b:j))i=f;if(i!=null)this.content[a]=this.content[i],this.content[i]=d,a=i;else break}}}},[]);
require.define({"gamejs/utils/objects":function(g,a){a.extend=function(a,d){if(a===void 0)throw Error("unknown subClass");if(d===void 0)throw Error("unknown superClass");var b=new Function;b.prototype=d.prototype;a.prototype=new b;a.prototype.constructor=a;a.superClass=d.prototype;a.superConstructor=d};a.merge=function(){for(var a={},d=arguments.length;d>0;--d){var b=arguments[d-1],e;for(e in b)a[e]=b[e]}return a};var f=a.keys=function(a){if(Object.keys)return Object.keys(a);var d=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,
b)&&d.push(b);return d},e=a.accessor=function(a,d,b,e){Object.defineProperty!==void 0?Object.defineProperty(a,d,{get:b,set:e}):Object.prototype.__defineGetter__!==void 0&&(a.__defineGetter__(d,b),e&&a.__defineSetter__(d,e))};a.accessors=function(a,d){f(d).forEach(function(b){e(a,b,d[b].get,d[b].set)})}}},[]);
require.define({"gamejs/image":function(g,a){var f=g("../gamejs"),e={};a.load=function(a){var d;if(typeof a==="string"){if(d=e[a],!d)throw Error('Missing "'+a+'", gamejs.preload() all images before trying to load them.');}else d=a;a=document.createElement("canvas");a.width=d.naturalWidth||d.width;a.height=d.naturalHeight||d.height;a.getContext("2d").drawImage(d,0,0);d.getSize=function(){return[d.naturalWidth,d.naturalHeight]};var b=new f.Surface(d.getSize());b._canvas=a;return b};a.init=function(){};
a.preload=function(a){function d(){b++;b%10==0&&f.log("gamejs.image: preloaded  "+b+" of "+g)}var b=0,g=0,k;for(k in a)if(!(k.indexOf("png")==-1&&k.indexOf("jpg")==-1&&k.indexOf("gif")==-1)){var i=new Image;i.addEventListener("load",function(){e[this.gamejsKey]=this;d()},!0);i.addEventListener("error",function(){d();throw Error("Error loading "+this.src);},!0);i.src=a[k];i.gamejsKey=k;g++}return function(){return g>0?b/g:1}}}},["gamejs"]);
require.define({"gamejs/mixer":function(g,a){g("../gamejs");var f={},e=!1;a.init=function(){var a=Array.prototype.slice.call(document.getElementsByTagName("audio"),0);c(a)};a.preload=function(a){var b=0,f=0,g;for(g in a)if(!(g.indexOf("wav")==-1&&g.indexOf("ogg")==-1&&g.indexOf("webm")==-1)){b++;var i=new Audio;i.addEventListener("canplay",function(){c(this);f++;f==b&&(e=!1)},!0);i.addEventListener("error",function(){f++;f==b&&(e=!1);throw Error("Error loading "+this.src);},!0);i.src=a[g];i.gamejsKey=
g;i.load()}b>0&&(e=!0);return function(){return b>0?f/b:1}};a.isPreloading=function(){return e};var c=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){f[a.gamejsKey]=a})};a.Sound=function(a){var b;b=typeof a==="string"?f[a]:a;if(!b)throw Error('Missing "'+a+'", gamejs.preload() all audio files before loading');var c=new Audio;c.preload="auto";c.loop="false";c.src=b.src;this.play=function(){(c.ended||c.paused)&&c.play()};this.stop=function(){c.pause()};this.setVolume=function(a){c.volume=
a};this.getVolume=function(){return c.volume};this.getLength=function(){return c.duration};return this}}},["gamejs"]);
